<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Shop Homepage - Start Bootstrap Template</title>
    <!-- فافايكون -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    
    <!-- Themify Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/themify-icons/0.2.0/css/themify-icons.css">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" />

    <!-- Core theme CSS -->
    <link rel="stylesheet" href="css/styles.css" />
    </head>
    <style>
.ti-shopping-cart, .ti-heart, .ti-zoom-in {
    font-size: 30px; /* تعديل الحجم */
    color: #fff; /* تعديل اللون */
}

.socal_icon a:hover {
    background: rgba(0, 0, 0, 0.8);  /* تغيير الخلفية عند المرور */
}


        .hero-section {
            background-image: url(/Backend/Masterpiece/Masterpiece/Uploads/thob2.png);
            background-size: cover;
            background-position: center;
            height:500px;
            background-position-y: -56px;
            width: 100%;
            height:70vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }
        header {
    padding-top: 10px;
    padding-bottom: 10px;
}
#carouselExampleSlidesOnly .carousel-inner {
    height: 700px; /* يمكنك تعديل هذا الرقم للتحكم في الارتفاع */
}

#carouselExampleSlidesOnly .carousel-inner img {
    height: 100%;
    object-fit: cover; /* لضبط الصورة داخل الإطار */
}
/* Custom Styles */
.card {
    border: none;
    border-radius: 15px;
    transition: transform 0.3s ease;
    height: 500px; /* تحديد الارتفاع الثابت للكارد بحيث يكون ثابت لكل الكروت */
    display: flex;
    flex-direction: column;
    justify-content: space-between; /* لضبط التباعد بين العناصر داخل الكارد */
}

.card-img-top {
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
    object-fit: cover; /* جعل الصورة تغطي كامل المساحة */
    height: 250px; /* تحديد ارتفاع الصورة */
}

.card-body {
    padding: 15px; /* تقليل الحشو ليكون متناسق */
    flex-grow: 1; /* جعل جسم الكارد ينمو ليشغل المساحة المتبقية */
}

.card-footer {
    background-color: #f8f9fa;
    border-bottom-left-radius: 15px;
    border-bottom-right-radius: 15px;
    padding: 10px 0; /* تقليل المسافة داخل الفوتر */
}

.price_box {
    font-size: 1.2rem;
    margin-top: 10px;
}

.current_price {
    font-weight: bold;
    color: #2d3e50;
}

.old_price {
    color: #d9534f;
    margin-left: 10px;
    font-size: 1rem;
}

/* زر إضافة إلى السلة */
.btn-outline-dark {
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.btn-outline-dark:hover {
    background-color: #212529;
    color: #fff;
}

/* Custom Styles */
/* Custom Styles */
.card {
    border: none;
    border-radius: 15px;
    transition: transform 0.3s ease;
    height: 600px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.card-img-top {
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
    object-fit: cover;
    height: 350px;
}

.card-body {
    padding: 15px;
    flex-grow: 1;
}

.card-footer {
    background-color: #f8f9fa;
    border-bottom-left-radius: 15px;
    border-bottom-right-radius: 15px;
    padding: 10px 0;
}

.price_box {
    font-size: 1.2rem;
    margin-top: 10px;
}

.current_price {
    font-weight: bold;
    color: #2d3e50;
}

.old_price {
    color: #d9534f;
    margin-left: 10px;
    font-size: 1rem;
}

/* زر Add to Cart */
.btn-outline-dark {
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.btn-outline-dark:hover {
    background-color: #212529;
    color: #fff;
}

/* رمز المنظار */
.icon-eye {
    display: none;
    font-size: 1.5rem;
    color: #007bff;
    cursor: pointer;
}

/* عرض رمز المنظار عند هوفر على Add to Cart */
.btn-outline-dark:hover .icon-eye {
    display: inline-block;
}

/* زر View Details */
.icon-eye:hover {
    color: #0056b3;
}
.ti-zoom-in {
        font-size: 24px; /* حجم الأيقونة */
        color: black; /* اللون */
    }
    .zoom-icon-container {
    display: inline-block;
    padding: 8px;
    margin-top: 10px;
    background-color: #000;  /* تغيير اللون إلى الأسود */
    border-radius: 5px;
    text-decoration: none;
}

.zoom-icon-container .zoom-icon {
    color: #fff;  /* تغيير لون الأيقونة إلى الأبيض */
    font-size: 20px;
}

.zoom-icon-container:hover {
    background-color: #333;  /* تغيير اللون عند التمرير */
}

.zoom-icon-container .zoom-icon:hover {
    color: #0d6efd;  /* تغيير لون الأيقونة عند التمرير */
}

header {
    background-color: #FF5733; /* تغيير اللون هنا */
} 

/* الميني كارت */
/* تنسيق الـ Mini Cart */
.mini_cart {
  position: absolute;
  top: 50px;
  right: 10px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
  width: 320px; /* تعديل العرض ليتسع للعناصر بشكل أفضل */
  max-height: 400px;
  overflow-y: auto;
  z-index: 1000;
  display: none;
  transition: all 0.3s ease-in-out;
}

.mini_cart .cart_header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #ddd;
  padding-bottom: 10px;
  margin-bottom: 10px;
}

.mini_cart .cart_header h4 {
  font-size: 18px;
  color: #333;
}

.mini_cart .cart_header .close_cart {
  font-size: 20px;
  color: #999;
  text-decoration: none;
}

.mini_cart .cart_header .close_cart:hover {
  color: #ff0000;
}

.mini_cart #cartGallery {
  max-height: 250px;
  overflow-y: auto;
}

.mini_cart .cart_item {
  display: flex;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid #f1f1f1;
  justify-content: space-between; /* تنسيق العناصر لتكون موزعة بشكل جيد */
}

.mini_cart .cart_img img {
  width: 50px;
  height: 50px;
  margin-left: 10px;
  object-fit: cover;
  border-radius: 5px;
}

.mini_cart .cart_info {
  flex-grow: 1;
  margin-left: 10px;
  min-width: 0; /* منع التمدد */
  overflow: hidden; /* إخفاء النص الطويل */
}

.mini_cart .cart_info a {
  font-size: 14px;
  color: #333;
  text-decoration: none;
  display: block;
  white-space: nowrap; /* منع النص من الانتقال إلى السطر التالي */
  text-overflow: ellipsis; /* إضافة نقاط (...) في حال كان النص طويلاً */
  overflow: hidden; /* إخفاء أي جزء من النص يتجاوز العرض */
}

.mini_cart .cart_info p {
  font-size: 12px;
  color: #666;
  margin-top: 5px;
}

.mini_cart .cart_remove a {
  color: #ff0000;
  font-size: 14px;
}

.mini_cart .cart_remove a:hover {
  color: #000;
}

.mini_cart .cart_footer {
  padding-top: 15px;
  border-top: 1px solid #f1f1f1;
  text-align: center;
}

.mini_cart .cart_footer p {
  font-size: 14px;
  color: #333;
}

.mini_cart .checkout_button {
  display: inline-block;
  margin-top: 10px;
  background-color: #007bff;
  color: #fff;
  padding: 10px 15px;
  border-radius: 5px;
  text-decoration: none;
}

.mini_cart .checkout_button:hover {
  background-color: #0056b3;
}

/* إزالة الخط الأزرق والنقاط من الأزرار */
button, a {
    text-decoration: none;  /* إزالة أي خط تحت النص */
    outline: none;  /* إزالة التأثير الأزرق عند الضغط على الزر */
    border: none;  /* إزالة أي حدود افتراضية */
}

button:focus, a:focus {
    outline: none;  /* إزالة التأثيرات عند التركيز */
}
/* إزالة أي تأثيرات إضافية عند التفاعل مع الـ button */
button:focus, a:focus {
    outline: none; /* إزالة التأثير الأزرق أو الحدود عند التفاعل */
    box-shadow: none; /* إزالة الظل إذا كان موجودًا */
}

a:focus, button:focus {
    outline: none;  /* إزالة أي حدود عند التركيز */
    box-shadow: none;  /* إزالة أي ظل */
}
.navbar {
    --bs-navbar-padding-x: 0;
    --bs-navbar-padding-y: 0.5rem;
    --bs-navbar-color: rgba(0, 0, 0, 0.55);
    --bs-navbar-hover-color: rgba(0, 0, 0, 0.7);
    --bs-navbar-disabled-color: rgba(0, 0, 0, 0.3);
    --bs-navbar-active-color: rgba(0, 0, 0, 0.9);
    --bs-navbar-brand-padding-y: 0.3125rem;
    --bs-navbar-brand-margin-end: 1rem;
    --bs-navbar-brand-font-size: 1.25rem;
    --bs-navbar-brand-color: rgba(0, 0, 0, 0.9);
    --bs-navbar-brand-hover-color: rgba(0, 0, 0, 0.9);
    --bs-navbar-nav-link-padding-x: 0.5rem;
    --bs-navbar-toggler-padding-y: 0.25rem;
    --bs-navbar-toggler-padding-x: 0.75rem;
    --bs-navbar-toggler-font-size: 1.25rem;
    --bs-navbar-toggler-icon-bg: url(data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%280, 0, 0, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e);
    --bs-navbar-toggler-border-color: rgba(0, 0, 0, 0.1);
    --bs-navbar-toggler-border-radius: 0.375rem;
    --bs-navbar-toggler-focus-width: 0.25rem;
    --bs-navbar-toggler-transition: box-shadow 0.15s ease-in-out;
    position: relative;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: space-between;
    /* padding: var(--bs-navbar-padding-y) var(--bs-navbar-padding-x); */
}
.bg-dark {
    background-color: #dfe2df; /* لون الخلفية الجديد */
}
#cartIcon::before,
#cartIcon::after,
#numberOfSelectedItems::before,
#numberOfSelectedItems::after {
    content: none !important;
}
.cart.mini_cart_wrapper {
    list-style: none;
}
#numberOfSelectedItems {
    outline: none;
    box-shadow: none;
    background-color: red; /* تأكد من بقاء اللون الأحمر للشارة */
}
#numberOfSelectedItems {
    top: 0; /* جرّب تعديل هذا الرقم */
    right: -5px; /* تعديل حسب الحاجة */
}
header {
    background-color: #f4cea8;
    color: #000;
}
.navbar {
    background-color: #f8f9fa; /* لون خلفية شريط التنقل */
    padding: 10px 20px; /* حشوة داخلية */
}

.nav-links {
    display: flex;
    justify-content: center; /* توسيط الروابط */
    align-items: center; /* محاذاة عمودية */
    flex-grow: 1; /* السماح للنمو لملء المساحة */
}

.nav-link {
    margin: 0 15px; /* مسافة بين العناصر */
    font-size: 16px; /* حجم الخط */
    color: #333; /* لون النص */
    text-decoration: none; /* إزالة التسطير */
    transition: color 0.3s; /* تأثير الانتقال */
}

.nav-link:hover {
    color: #007bff; /* لون عند التمرير */
}

.separator {
    margin: 0 5px; /* مسافة بين الفواصل */
    font-size: 16px; /* حجم الخط */
    color: #333; /* لون النص */
}
    </style>
    <body>
    <!-- Navigation-->
      <!-- الجزء الثاني (Header-Bottom) -->
      <div class="header-bottom text-center" style="background-color: #000; color: #fff;height: 50px;font-size: 16px;
      font-weight: 400;">
                  <p dir="rtl" style="padding-top: 10px;">تخفيضات تصل إلى 50%  أسرع ! العرض لفترة محدودة <a style="color:#cebd9c !important" href="shopp.html" class="browse-btn">تسوق الآن</a></p>
              </div>
              
    <nav class="navbar navbar-expand-lg navbar-light bg-light" dir="rtl">
        
        <div class="nav-links">
            <a href="/capitalshop/index.html" class="nav-link">الرئيسية</a>
            <span class="separator">/</span>
            <a href="index2.html" class="nav-link">حفلات الخطوبة والمناسبات</a>
        </div>
            <!-- زر السلة على اليمين -->
            <form class="d-flex me-auto">
                <li class="cart mini_cart_wrapper" style="position: relative;">
                    <a href="javascript:void(0)" style="display: flex; align-items: center;" id="cartIcon">
                        <!-- الأيقونة باستخدام Font Awesome -->
                        <button class="btn btn-outline-dark" type="button" style="display: flex; align-items: center; position: relative;">
                            <i class="fa fa-shopping-cart me-1" style="font-size: 20px;"></i>
                            السلة
                            <span class="badge bg-dark text-white ms-1 rounded-pill" id="numberOfSelectedItems" 
                            style="position: absolute; top: -5px; right: -10px; background-color: red; 
                            color: rgb(13, 13, 13); font-size: 12px; padding: 0 5px; box-shadow: none; 
                            border: none; outline: none;">
                            0
                        </span>
                        </button>
                    </a>
                    
                    <!-- القائمة المصغرة للمحتويات -->
                    <div class="mini_cart" style="display: none; position: absolute; top: 100%; left: 0; width: 300px; background-color: #fff; border: 1px solid #ddd; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); padding: 10px;" id="miniCart">
                        <div class="cart_gallery" id="cartGallery">
                            <!-- المحتويات هنا (مثل العناصر المضافة إلى السلة) -->
                            <p>لا يوجد عناصر في السلة</p>
                        </div>
                        <div class="mini_cart_footer">
                            <div class="cart_button">
                                <a href="/capitalshop/cart.html" style="font-size: 14px; width: 100%; height: 30px; display: inline-flex; justify-content: center; align-items: center; background-color: #333; color: white; text-decoration: none; border-radius: 5px;">
                                    <i class="fa fa-shopping-cart"></i> عرض السلة
                                </a>
                            </div>
                        </div>
                    </div>
                </li>
            </form>
        </div>
    </nav>
    
<!-- Header-->
<!-- Header-->
<header class="bg-#f4e3be py-3" style="background-color: #f3ead8;">
    <div class="container px-4 px-lg-5 my-5">
        <div class="text-center text-black">
            <h1 class="display-4 fw-bolder" style="margin-bottom:2% ;">فساتين أعراس وأثواب تقليدية</h1> <!-- تغيير النص هنا -->
            <p class="lead fw-normal text-black-50 mb-0">استعرض فساتين الأعراس الأنيقة والثياب التقليدية من مختلف الثقافات</p> <!-- تغيير النص هنا -->
        </div>
    </div>
</header>



        <div id="carouselExampleSlidesOnly" class="carousel slide" data-bs-ride="carousel" data-bs-interval="2000">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img class="d-block w-100" src="/Backend/Masterpiece/Masterpiece/Uploads/eee3.jpg" alt="First slide">
                </div>
                <div class="carousel-item">
                    <img class="d-block w-100" src="/Backend/Masterpiece/Masterpiece/Uploads/29.jpg" alt="Second slide">
                </div>
              
            </div>
        </div>
        

   
<!-- Section-->
<section class="py-5">
    <div class="container px-4 px-lg-5 mt-5">
        <div id="abayas-products-container" class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
            <!-- المنتجات ستظهر هنا ديناميكياً -->
        </div>
    </div>
</section>


        <!-- Footer-->
        <footer class="py-5 bg-dark">
            <div class="container"><p class="m-0 text-center text-white">Copyright &copy;RawaahAbabneh 2024</p></div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js"></script>


        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->


<script>
async function loadTopFiveAbayas() {
    try {
        let response = await fetch('https://localhost:44332/api/Products/GetTopFiveDress');
        let data = await response.json();

        console.log("Response data:", data);

        let container = document.getElementById('abayas-products-container');
        container.innerHTML = ''; 

        if (data && data.products && data.products.length > 0) {
            data.products.forEach(product => {
                const currentPrice = product.priceWithDiscount ? 
                    (product.price - (product.price * (product.priceWithDiscount / 100))).toFixed(2) : 
                    product.price.toFixed(2);
                const oldPrice = product.priceWithDiscount ? product.price.toFixed(2) : null;

                // إضافة الكروت إلى الصفحة
                container.innerHTML += `
           
<div class="col mb-5">
    <div class="card h-100">
        ${product.priceWithDiscount ? `<div class="badge bg-dark text-white position-absolute" style="top: 0.5rem; right: 0.5rem">Sale</div>` : ''}
        
        <!-- صورة المنتج -->
        <a href="/capitalshop/productdetalis1.html?productId=${product.productId}">
            <img class="card-img-top product-image" src="../../../../Backend/Masterpiece/Masterpiece/Uploads/${product.image}" alt="${product.name}">
        </a>

        <div class="card-body p-4">
            <div class="text-center">
                <h5 class="fw-bolder">${product.name}</h5>
                <div class="d-flex justify-content-center small text-warning mb-2">
                    <div class="bi-star-fill"></div>
                    <div class="bi-star-fill"></div>
                    <div class="bi-star-fill"></div>
                    <div class="bi-star-fill"></div>
                    <div class="bi-star-fill"></div>
                </div>
                <div class="price_box">
                    <span class="current_price">JD${currentPrice}</span>
                    ${oldPrice ? `<span class="old_price" style="text-decoration: line-through;">JD${oldPrice}</span>` : ''}
                </div>
            </div>
        </div>



  <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
    <div class="text-center">
        <!-- زر "Add to Cart" -->
        <a href="#" class="btn btn-outline-dark mt-auto" onclick="addToCart(${product.productId}, '${product.name}', ${currentPrice}, '${product.image}')">أضف إلى السلة </a>
        
        <!-- مربع الأيقونة مع تغيير اللون -->
        <a href="/capitalshop/productdetalis1.html?productId=${product.productId}" onClick="storeProductId(${product.productId})" class="zoom-icon-container">
            <i class="fa fa-search-plus zoom-icon"></i>
        </a>
    </div>
</div>

    </div>
</div>

                `;
            });
        } else {
            console.error('لا توجد منتجات متاحة حالياً.');
        }
    } catch (error) {
        console.error('Error fetching abayas:', error);
    }
}
// دالة لتخزين productId في localStorage وإعادة التوجيه إلى صفحة التفاصيل
function storeProductId(productId) {
    localStorage.setItem('productId', productId); // تخزين productId في localStorage
    window.location.href = 'productdetalis1.html'; // إعادة التوجيه إلى صفحة التفاصيل
}

//كود اضافة لسلة   

var UserId = localStorage.getItem("UserId");
debugger
async function addToCart(productId, name, price, image) {
debugger
    if (UserId != null) {
        debugger
        event.preventDefault();

        var url = `https://localhost:44332/api/Cart/AddCartItem/${UserId}`;
    
        var data = {
            ProductId: productId,
            Quantity: 1,
           
        };
        let response = await fetch(url, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
        });

        if (response.ok) {
            alert("Product added successfully to the cart!");

debugger
            let cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];

            // Check if the product is already in the cart
            let existingItem = cartItems.find((item) => item.product_id === productId);
    
            if (existingItem) {
                // If the product is already in the cart, update the quantity
                existingItem.quantity = parseInt(existingItem.quantity) + 1; // Increment quantity by 1
            } else {
                // If it's a new product, add it to the cart array
                cartItems.push(cartItem);
            }
    
            // Save the updated cart back to localStorage
            localStorage.setItem("cartItems", JSON.stringify(cartItems));

            // Redirect to the cart page
            window.location.href = "/capitalshop/cart.html"; // استبدل هذا بالرابط الصحيح
        } else {
            let error = await response.text();
            console.error("Error:", error);
        }
    } else {
        debugger
        const cartItem = {
            product_id: productId,
            quantity: 1,
            name: name,
            price: price,
            image: image,
        };
debugger
        // Check if there is already a cart in localStorage
        let cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];

        // Check if the product is already in the cart
        let existingItem = cartItems.find((item) => item.product_id === productId);

        if (existingItem) {
            // If the product is already in the cart, update the quantity
            existingItem.quantity = parseInt(existingItem.quantity) + 1; // Increment quantity by 1
        } else {
            // If it's a new product, add it to the cart array
            cartItems.push(cartItem);
        }

        // Save the updated cart back to localStorage
        localStorage.setItem("cartItems", JSON.stringify(cartItems));

        // تأكد من عرض تفاصيل المنتج
       alert(`Product added successfully to the cart!\nName: ${name}\nPrice: $${price}\nQuantity: ${cartItem.quantity}`);
        
        // Redirect to the cart page
        window.location.href = "/capitalshop/cart.html"; // استبدل هذا بالرابط الصحيح
    }
}
/////////////////////////////////

    // تحميل المنتجات عند تحميل الصفحة
    loadTopFiveAbayas();
    
</script>     

   <script src="js/scripts.js"></script>
 
<script src="/capitalshop/miniCart.js"></script>
    </body>
</html>
